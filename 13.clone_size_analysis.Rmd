---
title: "Run analysis of clone size vs time to MRCA"
author: "Dr Jacob Househam"
date: "24/06/2021"
output: html_document
---

```{r library}
options(scipen=6);library(data.table);library(wesanderson);library(dplyr);library(phangorn)
```

## Run clone size analysis and plot
## Figure S8
```{r clone_size}
# Get tree list and info
treelist <- readRDS('~/Documents/EPICC/Final/5.combiningwithATAC/allmultpat.treelist.rds')
tinfo <- readRDS('~/Documents/EPICC/Final/5.combiningwithATAC/allmultpat.infotrees.rds')
patients <- tinfo$patients

# Filter for only SNV eQTLs
newallDF <- readRDS('~/Documents/EPICC/Final/b.simpler_eQTL/alternative_eqtls.wog4.newclo.rds')
mutidDF <- newallDF[which(newallDF$ModeladjP<0.01 & newallDF$MutadjP<0.05 & newallDF$ClonalityRNA!='clonal'),]
snvidDF <- mutidDF[which(nchar(gsub('.+_(\\S+)$','\\1',mutidDF$Locus))==3),];row.names(snvidDF) <- c(1:nrow(snvidDF))


```


